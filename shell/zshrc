# Vedran's Zsh Configuration Loader
# Detects OS and sources appropriate config files

# Resolve the actual location of this file (follows symlink from ~/.zshrc)
if [[ -L "$HOME/.zshrc" ]]; then
    DOTFILES_SHELL="$(dirname "$(readlink -f "$HOME/.zshrc" 2>/dev/null || readlink "$HOME/.zshrc")")"
else
    DOTFILES_SHELL="${0:A:h}"
fi

# Source common configuration (works on all platforms)
source "$DOTFILES_SHELL/zshrc.common"

# Detect OS and source platform-specific config
case "$(uname -s)" in
    Darwin)
        source "$DOTFILES_SHELL/zshrc.macos"
        ;;
    Linux)
        if grep -qi microsoft /proc/version 2>/dev/null; then
            source "$DOTFILES_SHELL/zshrc.wsl"
        else
            source "$DOTFILES_SHELL/zshrc.linux"
        fi
        ;;
esac

test -e "${HOME}/.iterm2_shell_integration.zsh" && source "${HOME}/.iterm2_shell_integration.zsh"
